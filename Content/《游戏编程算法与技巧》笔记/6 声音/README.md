# 6 声音

## 声音系统

1. 游戏一般会设置声音事件, 将游戏中的一个事件映射到一个或多个声音文件上进行播放
2. 声音文件的播放一般会经由场景预加载节省时间, 并为了节省内存采用流式加载(只按需加载一部分)
3. 声音事件常常由较复杂的场景设计, 最常见的就是脚步事件在角色不同状态, 不同地面环境, 不同周边环境, 当前事件不同优先级下, 播放不同的音频. 因此实现声音系统关键是提供足够的信息去判断所需播放什么声音

## 3D声音

1. 2D游戏一般声音与方向无关, 一部分会考虑音源距离
2. 3D游戏考虑得很多, 需要设置虚拟监听者和虚拟发射者. 第一人称游戏的情况最简单, 监听者就是相机的方向和相机朝向即可
3. 第三人称动作游戏的监听者比较难设置, 比较好的设置是监听者的位置在相机与角色之间中点附近的位置, 朝向等于相机的朝向, 具体视需求而定
4. 发射者最基础的设置是音量大小和衰减半径, 超出半径距离的时候就按照衰减函数减少音量, 直到音量为0
5. 大多数设备只支持立体声, 对应环绕声的开发可能不是很划算

## 声音处理

1. 常见的声音处理效果有:
   1. 回声: 模拟狭窄空间的回声
   2. 音高偏移: 模拟多普勒效应, 常见于竞速游戏, 靠近频率上升, 远离频率下降
   3. 频率压缩: 统一不同大小的声音
   4. 低通滤波: 模拟爆炸的轰鸣声和音量遮挡效果
2. 音量遮挡: 最简单的遮挡效果通过判断监听者到发射者之间有无阻挡并应用低通滤波即可, 复杂的遮挡可以使用Fresnel声学衍射模拟音波的传播效果