# Chapter2 专业工具

## 2.1 版本控制

版本控制的目的是允许多个开发者在同个项目上合作，会自动记录文件的每个改动并在需要的时候可以还原改动，甚至能让多个用户修改同一份文件，不过最好是文本文件。就算是单人项目，版本控制系统的历史记录，分支和标签等功能也很实用。

版本控制系统有很多可选的，一般来说个人选择Git，专业级选择Perforce即可。游戏领域有还有类似NxN Alienbrain，ClearCase这样的专门为游戏优化的系统。

版本控制系统的核心是维护主（master）版本，然后对比每个提交（commit）的文件与当前文件的区别（diff），将修改的部分保存log，然后改动。程序员可以随时回到之前的每个commit时的快照（snapshot）中。如果多个commit之间在某部分代码产生了冲突，则需要合并（merge）改动，一些改动可以自动合并，一些需要手动控制。在版本控制系统中删除的文件只会被标记而不会真的被删除，可以随时通过snapshot找回之前的文件。

## 2.2 微软 Visual Studio

C++之类的编译型语言需要使用编译器和链接器来将代码转换为可执行文件。VS作为集成开发环境（IDE）包含了完善的文本编辑器，编译器，链接器，调试器等种种组件，很方便使用。

程序的执行的过程：
1. C++编写的程序由源文件组成，预处理器首先将所有宏命令（#号开头的行，例如头文件）替换为对应的文本内容，此时的文件称为翻译单元
2. 然后编译器将所有翻译单元翻译为机器码（这其中还有汇编器的协助），此时称为对象文件，扩展名为.obj或.o。此时的对象文件已经是可以执行的代码，但是还没有决定代码的内存地址且一些文件中存在不属于该文件的外部数据，也就是可重定位且未链接
3. 对象文件可以集成为程序库交付给其他程序一起使用，使用的方法是链接
4. 链接器会将所有对象文件和程序库进行符号查找，计算出所有代码的相对位置和所有完成解析的外部数据，称为可执行文件，windows下的扩展名为.exe
5. 可执行文件虽然已经是完整的但是其内存地址仍然是浮动的相对值，执行的时候操作系统将给程序指定一个内存的最终基址并载入内存，这样机器才会真正执行程序

在这个流程中比较特别的存在是动态链接库（DLL），其既像静态链接库一样是包含了很多函数的可以用来与其他程序链接使用的程序库，又像可执行文件一样可以正常执行。使用了DLL的程序中会存在未完全链接的代码，这使得程序可以正常运行，但是当遇到这些代码时操作系统会寻找合适的DLL，若DLL不在内存中就会进行载入，这样的优点是实现了程序库级别的代码，且使得我们可以只修改DLL而不用修改可执行文件。

而在这之外，VS又为C++包装了项目文件.vcxproj，这是一个xml文件汇集了项目包含的源文件，可执行文件，DLL等信息方便使用。除此之外还包装了更上一层的解决方案文件.sln，其是项目的集合，并组织了与本机路径无关的树状文件目录结构。当然，按照真实目录来设置解决方案的目录是好习惯。

VS中开始生成项目需要生成配置文件，其就是包含了对这个项目的预处理器链接器等等组件的设置配置。大多数软件项目都有调试（Debug）和发布（Release）两套组件配置，一个生成的程序包含很多调试信息且运行较慢，另一个关闭了调试信息得到了更高的运行速度。

典型的生成配置